<p id="notice"><%= notice %></p>

<div class="raffle-info">
  <h1><%= @raffle.name %></h1>
  <h3>by: <%= @raffle.user.name %></h3>
  <p>
    <strong>Description:</strong>
    <%= @raffle.description %>
  </p>
  <p>
    <strong>Final date:</strong>
    <%= @raffle.final_date %>
  </p>
  <p>
    <strong>Price:</strong>
    <%= @raffle.price %>
  </p>
  <p>
    <strong>Raffle category:</strong>
    <%= @raffle.raffle_category.name %>
  </p>
  <p>
    <strong>Collected money:</strong>
    <%= @raffle.collected_money %>
  </p>

</div>

<h2>Prizes for this raffle</h2>
<h2>Comments</h2>

<% if !@raffle.comments.blank? %>
  <% for comment in @raffle.comments %>
    <div class="comment">
      <h4><%=comment.user.name%> said:</h4>
      <div class="comment-content">
        <% if !comment.answered.blank? %>
          <p><strong>As an answer for what <%=comment.answered.user.name%> said:</strong></p>
          <p class="comment-content"><%= comment.answered.content%></p>
        <% end %>
        <p><%= comment.content%></p>
      </div>
      <p class="date"><b>Last modification:</b> <%= comment.updated_at%></p>
      <% if logged_in? %>
      <div class="">
        <% if current_user?(comment.user) %>
          <%= link_to 'Edit', edit_raffle_comment_path(id: comment.id,
                                                       raffle_id: @raffle.id),
                              class:"normal-button"%>
          <%= link_to 'Destroy', raffle_comment_path(id: comment.id,
                                                     raffle_id: @raffle.id),
                                 method: :delete,
                                 data: { confirm: 'Are you sure?' },
                                 class:"normal-button" %>
        <% else %>
          <%= link_to 'Answer', new_raffle_comment_comment_path(comment_id: comment.id,
                              raffle_id: @raffle.id),
                              class:"normal-button"%>
        <% end %>

      </div>
      <% end %>
      <% if !comment.answers.blank? %>
        <p><strong>Answers:</strong></p>
          <div class="answers">
            <% for answer in comment.answers %>
              <p><strong><%= answer.user.name%> answered:</strong></p>
              <p class="comment-content"><%= answer.content%></p>
            <% end %>
          </div>
      <% end %>

    </div>
  <% end %>
<% end %>

<% if logged_in? %>
  <div class="new-comment">
    <h1>Make a comment</h1>
    <div class="input-list">
      <%= render 'form_comment', comment: @comment %>
    </div>
  </div>
<% end %>



<% if logged_in? && (creator_user?(@raffle) || current_user.admin?) %>
<%= link_to 'Add Prize', raffle_prizes_path(@raffle.id) %> |
  <%= link_to 'Edit', edit_raffle_path(@raffle) %> |
  <%= button_to 'Draw the raffle', raffle_draw_raffle_path(@raffle.id) %> |
<% else %>
<%= link_to 'Bought numbers', raffle_numbers_path(@raffle) %>|
<%= link_to 'Buy a number', raffle_numbers_path(@raffle.id), method: :create, data: { confirm: 'Are you sure?'} %> |
<% end %>
<%= link_to 'Back', raffles_path %>
